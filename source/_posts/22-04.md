title: 日志宏
author: weihehe
tags:
  - 日志
categories:
  - 项目
date: 2024-09-13 22:03:00
---
一个简单的日志
<!--more-->

## 时间 

- `#include <ctime>`
包含处理日期和时间的库，用于获取当前时间和格式化时间。

- `time_t t = time(NULL);`：获取当前时间。

- `char time_tmp[32] = { 0 };`：初始化一个字符数组，用于存储格式化后的时间字符串。
	- `strftime(time_tmp,sizeof(time_tmp), "%m-%d %H:%M:%S", lt);`：使用 `strftime` 函数将时间格式化为 `"MM-DD HH:MM:SS"` 的形式，并存入 `time_tmp` 数组。
	
    - `函数原型：size_t strftime(char *s, size_t max, const char *format, const struct tm *tm);`
`

- format, ...`：这是一个带有可变参数的宏，`format` 是一个格式化字符串，`...` 表示可以接受任意数量的参数（可变参数）。

-  `__FILE__`,` __LINE__`分别代表文件位置和哪一行。

```cpp
#define LDBG 0
#define LINF 1
#define LERR 2

#define LDEFAULT LINF
  
// 末尾的换行\是转义，让其视为同一行。设置不定参数，获取当前时间并打印日志  
#define LOG(level,format, ...) {\  
    if(level >= LDEFAULT){\
    time_t t = time(NULL);\  
    struct tm *lt = localtime(&t);\  
    char time_tmp[32] = { 0 };\  
    strftime(time_tmp, sizeof(time_tmp), "%m-%d %H:%M:%S", lt);\  
    printf("[%s]-[%s:%d] " format "\n", time_tmp, __FILE__, __LINE__, ##__VA_ARGS__);\ 
    }\
}
/*输出等级控制 */
#define DLOG(format, ...) LOG(LDBG, format, ##__VA_ARGSS__);
#define ILOG(format, ...) LOG(LINF, format, ##__VA_ARGSS__);
#define ELOG(format, ...) LOG(LERR, format, ##__VA_ARGSS__);
```