title: 多继承和菱形继承
author: weihehe
tags:
  - 继承
categories:
  - C++
date: 2024-07-05 16:34:00
---
菱形继承和菱形虚拟继承
<!-- more -->

## 多继承(慎重使用)

一个子类**有两个或以上直接父类**时称这个继承关系为多继承

### 由多继承导致的菱形继承

![菱形继承](/images/菱形继承_1.png)


#### 对象模型
![菱形继承的对象模型](/images/多继承_01.png)

- 数据冗余：数据冗余是指**基类成员的多个副本包含在派生类中的情况**，从而造成的内存资源浪费。
  - 解决方案
    - 虚继承

- 二义性：由于继承时可能有多个同名成员，而在访问时不知道要访问哪一个。

  - **解决方案**：
    - 虚继承
    - 指定基类
  
  
![指定基类解决二义性](/images/多继承_2.png)

### 虚继承


![怎么添加virtual](/images/多继承_3.png)

#### 对象模型

![多继承](/images/pasted-11.png)

- 具体对象`d`存放的位置是由编译器来决定的。
- 额外**记录了相对于`A`的偏移量**（途中为十六进制）。
- 为什么要**记录一个指针，指向额外空间用来记录偏移量，而不在所属的对象内直接保存呢？**
	- 目的是为了可以处理更多的冲突变量，便于添加变量。
    
![upload successful](/images/多继承_4.png)

**运用**

![upload successful](/images/多继承_5.png)

**总结：取到偏移量，再计算地址，再去访问。**